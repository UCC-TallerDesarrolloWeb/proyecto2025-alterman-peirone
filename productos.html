<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Detalle del producto</title>
  <link rel="stylesheet" href="css/style.css">
  <link rel="icon" href="FAVICON/favicon-32x32.png" type="image/png" />
</head>
<body>
  <!-- Header -->
  <header>
    <a class="logo" href="index.html">CrewLab</a>
    <div class="acciones">
      <div class="carrito">ðŸ›’</div>
      <div class="menu-hamburguesa" id="menu-btn">â˜°</div>
      <nav class="menu-desplegable" id="menu">
        <ul>
          <li><a href="remeras.html">Remeras</a></li>
          <li><a href="buzos.html">Buzos</a></li>
          <li><a href="pantalones.html">Pantalones</a></li>
          <li><a href="zapatillas.html">Zapatillas</a></li>
        </ul>
      </nav>
    </div>
  </header>

  <!-- Contenido del producto -->
  <main>
    <div class="producto-detalle">
      <div class="imagenes">
        <img id="producto-img" src="" alt="Producto">
      </div>
      <div class="info">
        <h1 id="producto-nombre"></h1>
        <p id="producto-precio"></p>

        <label for="talle">Seleccionar talle:</label>
        <select id="talle"></select>

        <label for="cantidad">Cantidad:</label>
        <input type="number" id="cantidad" min="1" value="1">

        <button id="btn-agregar">Agregar al carrito</button>
      </div>
    </div>
  </main>

  <script>
    // --- Lista de productos (recortada como ejemplo) ---
    const productos = [
      { id: 1, nombre: "Remera Azul Design", precio: 30000, img: "REMERAS/Remera Azul Design.jpg", talles: ["XS","S","M","L","XL","2XL","3XL"], descripcion: "DiseÃ±o exclusivo y vibrante.", imagenes_adicionales: ["REMERAS/Remera Azul Design-Detras.jpg"] },
    { id: 2, nombre: "Remera Blanca Basic", precio: 33000, img: "REMERAS/Remera Blanca Basic.jpg", talles: ["XS","S","M","L","XL","2XL","3XL"], descripcion: "AlgodÃ³n suave y fit perfecto.", imagenes_adicionales: ["REMERAS/Remera Blanca Basic-Perfil.jpg"] },
    { id: 3, nombre: "Remera Crema Simply", precio: 37000, img: "REMERAS/Remera Crema Simply.jpg", talles: ["XS","S","M","L","XL","2XL","3XL"], descripcion: "Tono neutro, ideal para combinar.", imagenes_adicionales: ["REMERAS/Remera Crema Simply-Detras.jpg"] },
    { id: 4, nombre: "Remera Gris over-estampada", precio: 41000, img: "REMERAS/Remera Gris over-estampada.jpg", talles: ["XS","S","M","L","XL","2XL","3XL"], descripcion: "Estampado grande y look urbano.", 
        // RUTA CORREGIDA (CapitalizaciÃ³n de la R y G)
        imagenes_adicionales: ["REMERAS/Remera Gris over-estampada-detras.png"] 
    },
    { id: 5, nombre: "Remera Negra Basic", precio: 45000, img: "REMERAS/Remera Negra Basic.jpg", talles: ["XS","S","M","L","XL","2XL","3XL"], descripcion: "El clÃ¡sico que nunca falla.", imagenes_adicionales: ["REMERAS/Remera Negra Basic-Detras.jpg"] },
    // Buzos
    { id: 7, nombre: "Buzo blanco bordado", precio: 60000, img: "BUZOS/buzo blanco bordado.jpg", talles: ["XS","S","M","L","XL","2XL","3XL"], descripcion: "Detalle bordado de alta precisiÃ³n.", imagenes_adicionales: ["BUZOS/buzo blanco bordado-2.jpg"] },
    { id: 8, nombre: "Buzo design", precio: 70000, img: "BUZOS/buzo design.jpg", talles: ["XS","S","M","L","XL","2XL","3XL"], descripcion: "DiseÃ±o grÃ¡fico Ãºnico y moderno.", imagenes_adicionales: ["BUZOS/buzo design-2.jpg"] },
    { id: 9, nombre: "Buzo gris desgastado", precio: 75000, img: "BUZOS/buzo gris desgastado.jpg", talles: ["XS","S","M","L","XL","2XL","3XL"], descripcion: "Efecto vintage desgastado.", imagenes_adicionales: ["BUZOS/buzo gris desgastado-2.jpg"] },
    { id: 10, nombre: "Buzo gris estampado", precio: 80000, img: "BUZOS/buzo gris estampado.jpg", talles: ["XS","S","M","L","XL","2XL","3XL"], descripcion: "Estampado minimalista en la espalda.", imagenes_adicionales: ["BUZOS/buzo gris estampado-2.jpg"] },
    { id: 11, nombre: "Buzo negro basic", precio: 90000, img: "BUZOS/buzo negro basic.jpg", talles: ["XS","S","M","L","XL","2XL","3XL"], descripcion: "Buzo clÃ¡sico de friza de algodÃ³n.", 
        // RUTA CORREGIDA (Simplificado el nombre de archivo con extensiÃ³n errÃ³nea)
        imagenes_adicionales: ["BUZOS/buzo negro basic-2.jpg"] 
    },
    { id: 12, nombre: "Buzo negro desgastado", precio: 100000, img: "BUZOS/buzo negro desgastado.jpg", talles: ["XS","S","M","L","XL","2XL","3XL"], descripcion: "Proceso de teÃ±ido artesanal para un look Ãºnico.", imagenes_adicionales: ["BUZOS/buzo negro desgastado-2.jpg"] },
    // Pantalones
    { id: 13, nombre: "Cargo color crema", precio: 100000, img: "PANTALONES/Cargo color crema.avif", talles: ["XS","S","M","L","XL","2XL","3XL"], descripcion: "Tela ripstop resistente con mÃºltiples bolsillos.", imagenes_adicionales: ["REMERAS/Remera Blanca Basic-Perfil.jpg"] },
    { id: 14, nombre: "Cargo color marrÃ³n", precio: 105000, img: "PANTALONES/Cargo color marron.jpg", talles: ["XS","S","M","L","XL","2XL","3XL"], descripcion: "Cargo de corte recto y acabado mate.", imagenes_adicionales: ["PANTALONES/Cargo color marron-2.jpg"] },
    { id: 15, nombre: "Cargo color negro (con puÃ±o)", precio: 110000, img: "PANTALONES/Cargo color Negro (con puÃ±o).jpg", talles: ["XS","S","M","L","XL","2XL","3XL"], descripcion: "Ajuste cÃ³modo en el tobillo y costuras reforzadas.", imagenes_adicionales: ["PANTALONES/Cargo color Negro (con puÃ±o)-2.jpg"] },
    { id: 16, nombre: "Cargo color verde clarito", precio: 115000, img: "PANTALONES/Cargo color verde clarito.jpg", talles: ["XS","S","M","L","XL","2XL","3XL"], descripcion: "Estilo militar moderno en tono claro.", imagenes_adicionales: ["PANTALONES/Cargo color verde clarito-2.jpg"] },
    { id: 17, nombre: "Jean azulado", precio: 120000, img: "PANTALONES/Jean azulado.webp", talles: ["XS","S","M","L","XL","2XL","3XL"], descripcion: "Denim de lavado oscuro, fit relaxed.", imagenes_adicionales: ["PANTALONES/Jean azulado-2.jpg"] },
    { id: 18, nombre: "Jean clarito", precio: 122000, img: "PANTALONES/Jean clarito.jpeg", talles: ["XS","S","M","L","XL","2XL","3XL"], descripcion: "Jean con lavado claro, ideal para verano.", imagenes_adicionales: ["PANTALONES/Jean clarito-2.jpg"] },
    { id: 19, nombre: "Jean clÃ¡sico", precio: 125000, img: "PANTALONES/Jean clasico.jpg", talles: ["XS","S","M","L","XL","2XL","3XL"], descripcion: "Corte recto, el denim de siempre.", imagenes_adicionales: ["PANTALONES/Jean clasico-2.jpg"] },
    { id: 20, nombre: "Jean desgastado", precio: 127000, img: "PANTALONES/Jean desgastado.jpg", talles: ["XS","S","M","L","XL","2XL","3XL"], descripcion: "Efecto de uso natural y cÃ³modo.", imagenes_adicionales: ["PANTALONES/Jean desgastado-2.jpg"] },
    { id: 21, nombre: "Jean oscuro", precio: 130000, img: "PANTALONES/Jean oscuro.jpg", talles: ["XS","S","M","L","XL","2XL","3XL"], descripcion: "Color oscuro, denim rÃ­gido de alta duraciÃ³n.", imagenes_adicionales: ["PANTALONES/Jean oscuro-2.jpg"] },
    // Zapatillas
    { id: 22, nombre: "Adidas Campus Gris", precio: 165000, img: "ZAPATILLAS/Adidas Campus Gris.webp", talles: ["38","39","40","41","42","43","44"], descripcion: "ClÃ¡sico renovado en gamuza gris.", imagenes_adicionales: ["ZAPATILLAS/Adidas Campus Gris-2.webp"] },
    { id: 23, nombre: "Adidas Samba clÃ¡sicas blancas", precio: 170000, img: "ZAPATILLAS/Adidas samba clasicas blancas.avif", talles: ["38","39","40","41","42","43","44"], descripcion: "Silueta icÃ³nica con detalles en cuero.", imagenes_adicionales: ["ZAPATILLAS/Adidas samba clasicas blancas-2.avif"] },
    { id: 24, nombre: "Adidas Samba clÃ¡sicas negras", precio: 180000, img: "ZAPATILLAS/Adidas samba clasicas negras.avif", talles: ["38","39","40","41","42","43","44"], descripcion: "El modelo retro mÃ¡s buscado, mÃ¡xima calidad.", 
        // RUTA CORREGIDA (CapitalizaciÃ³n de la S de Samba)
        imagenes_adicionales: ["ZAPATILLAS/Adidas Samba clÃ¡sicas negras-2.avif"] 
    },
    { id: 25, nombre: "Campus verdes", precio: 195000, img: "ZAPATILLAS/campus verdes.avif", talles: ["38","39","40","41","42","43","44"], descripcion: "Color vibrante, estilo urbano.", imagenes_adicionales: ["ZAPATILLAS/campus verdes-2.avif"] },
    { id: 26, nombre: "Vans Knu blanco-negro", precio: 200000, img: "ZAPATILLAS/Vans Knu blanco-negro.jpg", talles: ["38","39","40","41","42","43","44"], descripcion: "El skate-shoe de los 90s, mÃ¡xima comodidad.", imagenes_adicionales: ["ZAPATILLAS/Vans Knu blanco-negro-2.jpg"] },
    { id: 27, nombre: "Vans Knu Negras", precio: 210000, img: "ZAPATILLAS/Vans Knu Negras.jpg", talles: ["38","39","40","41","42","43","44"], descripcion: "VersiÃ³n chunky, tendencia actual.", imagenes_adicionales: ["ZAPATILLAS/Vans Knu Negras-2.jpg"] }
    ];

    // --- Leer parÃ¡metro ID de la URL ---
    const params = new URLSearchParams(window.location.search);
    const id = parseInt(params.get("id"));

    // --- Buscar producto ---
    const producto = productos.find(p => p.id === id);

    if (producto) {
      document.getElementById("producto-img").src = producto.img;
      document.getElementById("producto-nombre").textContent = producto.nombre;
      document.getElementById("producto-precio").textContent = "$" + producto.precio.toLocaleString("es-AR");

      const talleSelect = document.getElementById("talle");
      talleSelect.innerHTML = "";
      (producto.talles || []).forEach(t => {
        const option = document.createElement("option");
        option.value = t;
        option.textContent = t;
        talleSelect.appendChild(option);
      });
    } else {
      document.querySelector("main").innerHTML = "<h2>Producto no encontrado</h2>";
    }

    // --- Carrito persistente ---
    const STORAGE_KEY = "crewlab_carrito";
    let carrito = JSON.parse(localStorage.getItem(STORAGE_KEY)) || [];

    function saveCart() {
      localStorage.setItem(STORAGE_KEY, JSON.stringify(carrito));
      updateCartBadge();
    }

    // Modal carrito
    let carritoModal = document.getElementById("carrito-modal");
    if (!carritoModal) {
      carritoModal = document.createElement("div");
      carritoModal.id = "carrito-modal";
      carritoModal.className = "carrito-modal oculto";
      carritoModal.innerHTML = `
        <h2>Tu carrito ðŸ›’</h2>
        <ul id="carrito-lista"></ul>
        <p id="carrito-total">Total: $0</p>
        <button id="finalizar-compra">Finalizar compra</button>
        <button id="cerrar-carrito">Cerrar</button>
      `;
      document.body.appendChild(carritoModal);
    }

    const carritoLista = document.getElementById("carrito-lista");
    const carritoTotal = document.getElementById("carrito-total");
    const cerrarCarritoBtn = document.getElementById("cerrar-carrito");
    const finalizarCompraBtn = document.getElementById("finalizar-compra");

    const carritoIcon = document.querySelector(".carrito");
    if (carritoIcon) {
      carritoIcon.style.cursor = "pointer";
      carritoIcon.addEventListener("click", () => {
        carritoModal.classList.toggle("oculto");
        renderCart();
      });
    }

    if (cerrarCarritoBtn) {
      cerrarCarritoBtn.addEventListener("click", () => {
        carritoModal.classList.add("oculto");
      });
    }

    if (finalizarCompraBtn) {
      finalizarCompraBtn.addEventListener("click", () => {
        window.location.href = "checkout.html";
      });
    }

    function addToCart(product) {
      const existente = carrito.find(i => i.nombre === product.nombre);
      if (existente) existente.cantidad += product.cantidad;
      else carrito.push({ ...product });
    }

    function renderCart() {
      if (!carritoLista) return;
      carritoLista.innerHTML = "";
      let total = 0;

      carrito.forEach((item, index) => {
        total += item.precio * item.cantidad;
        const li = document.createElement("li");
        li.className = "carrito-item";
        li.innerHTML = `
          <div class="item-info">
            <strong>${item.nombre}</strong>
            <div>$${item.precio}</div>
          </div>
          <div class="item-ctrls">
            <button class="cantidad-menos" data-index="${index}">-</button>
            <span>${item.cantidad}</span>
            <button class="cantidad-mas" data-index="${index}">+</button>
            <button class="eliminar" data-index="${index}">Eliminar</button>
          </div>
        `;
        carritoLista.appendChild(li);
      });

      carritoTotal.textContent = "Total: $" + total;
      updateCartBadge();
    }

    function updateCartBadge() {
      const count = carrito.reduce((s, i) => s + i.cantidad, 0);
      if (!carritoIcon) return;
      let badge = carritoIcon.querySelector(".carrito-badge");
      if (!badge) {
        badge = document.createElement("span");
        badge.className = "carrito-badge";
        carritoIcon.appendChild(badge);
      }
      badge.textContent = count > 0 ? count : "";
    }

    // Eventos dentro del carrito modal
    document.addEventListener("click", (e) => {
      if (e.target.classList.contains("eliminar")) {
        const idx = Number(e.target.dataset.index);
        carrito.splice(idx, 1);
        saveCart();
        renderCart();
      }
      if (e.target.classList.contains("cantidad-mas")) {
        const idx = Number(e.target.dataset.index);
        carrito[idx].cantidad++;
        saveCart();
        renderCart();
      }
      if (e.target.classList.contains("cantidad-menos")) {
        const idx = Number(e.target.dataset.index);
        carrito[idx].cantidad = Math.max(1, carrito[idx].cantidad - 1);
        saveCart();
        renderCart();
      }
    });

    // BotÃ³n agregar producto desde detalle
    const btnAgregar = document.getElementById("btn-agregar");
    if (btnAgregar && producto) {
      btnAgregar.addEventListener("click", () => {
        const talle = document.getElementById("talle").value;
        const cantidad = parseInt(document.getElementById("cantidad").value);

        const productoSeleccionado = {
          nombre: producto.nombre + " (Talle: " + talle + ")",
          precio: producto.precio,
          cantidad: cantidad
        };

        addToCart(productoSeleccionado);
        saveCart();
        renderCart();
        alert("Producto agregado al carrito âœ…");
      });
    }

    // MenÃº desplegable
    const menuBtn = document.getElementById("menu-btn");
    const menu = document.getElementById("menu");
    if (menuBtn && menu) {
      menuBtn.addEventListener("click", () => {
        menu.classList.toggle("activo");
      });

      document.addEventListener("click", (e) => {
        if (!menu.contains(e.target) && !menuBtn.contains(e.target)) {
          menu.classList.remove("activo");
        }
      });
    }

    renderCart();
  </script>
</body>
</html>
